define("discourse/routes/application",["discourse/lib/ajax","discourse/lib/computed","discourse/lib/logout","discourse/lib/show-modal","discourse/mixins/open-composer","discourse/models/category","discourse/lib/mobile","discourse/models/login-method","exports"],function(e,o,t,i,n,s,r,a,l){"use strict";function c(e,o){return function(){this.site.get("isReadOnly")?bootbox.alert(o):this[e]()}}var u=e.ajax,d=o.setting,h=t.default,g=i.default,p=n.default,m=s.default,f=r.default,w=a.findAll,_=Discourse.Route.extend(p,{siteTitle:d("title"),_handleLogout:function(){var e=this;this.currentUser&&this.currentUser.destroySession().then(function(){return h(e.siteSettings,e.keyValueStore)})},actions:{showSearchHelp:function(){u("/static/search_help.html",{dataType:"html"}).then(function(e){g("searchHelp",{model:e})})},toggleAnonymous:function(){u("/users/toggle-anon",{method:"POST"}).then(function(){window.location.reload()})},toggleMobileView:function(){f.toggleMobileView()},logout:c("_handleLogout",I18n.t("read_only_mode.logout_disabled")),_collectTitleTokens:function(e){e.push(this.get("siteTitle")),Discourse.set("_docTitle",e.join(" - "))},willTransition:function(){var e=this.container.lookup("router:main");return Ember.run.once(e,e.trigger,"willTransition"),this._super()},showTopicEntrance:function(e){this.controllerFor("topic-entrance").send("show",e)},postWasEnqueued:function(e){var o=e.reason?"queue_reason."+e.reason+".title":"queue.approval.title";g("post-enqueued",{model:e,title:o})},composePrivateMessage:function(e,o){var t=e?e.get("username"):"",i=o?window.location.protocol+"//"+window.location.host+o.get("url"):null,n=require("discourse/models/composer").default;return this.controllerFor("composer").open({action:n.PRIVATE_MESSAGE,usernames:t,archetypeId:"private_message",draftKey:"new_private_message",reply:i})},error:function(e,o){var t={};e.jqXHR&&(t=e.jqXHR);var i=e.jqXHR?t:e,n=this.controllerFor("exception"),s=window.console;return s&&s.error&&s.error(i),n.setProperties({lastTransition:o,thrown:i}),this.intermediateTransitionTo("exception"),!0},showLogin:c("handleShowLogin",I18n.t("read_only_mode.login_disabled")),showCreateAccount:c("handleShowCreateAccount",I18n.t("read_only_mode.login_disabled")),showForgotPassword:function(){g("forgotPassword",{title:"forgot_password.title"})},showNotActivated:function(e){g("not-activated",{title:"log_in"}).setProperties(e)},showUploadSelector:function(e){g("uploadSelector").setProperties({toolbarEvent:e,imageUrl:null,imageLink:null})},showKeyboardShortcutsHelp:function(){g("keyboard-shortcuts-help",{title:"keyboard_shortcuts_help.title"})},closeModal:function(){this.render("hide-modal",{into:"modal",outlet:"modalBody"})},hideModal:function(){$("#discourse-modal").modal("hide")},reopenModal:function(){$("#discourse-modal").modal("show")},editCategory:function(e){var o=this;m.reloadById(e.get("id")).then(function(e){var t=o.store.createRecord("category",e.category);t.setupGroupsAndPermissions(),o.site.updateCategory(t),g("editCategory",{model:t}),o.controllerFor("editCategory").set("selectedTab","general")})},deleteSpammer:function(e){this.send("closeModal"),e.deleteAsSpammer(function(){window.location.reload()})},checkEmail:function(e){e.checkEmail()},changeBulkTemplate:function(e){var o=e.replace("modal/",""),t=this.container.lookupFactory("controller:"+o);this.render(e,{into:"modal/topic-bulk-actions",outlet:"bulkOutlet",controller:t?o:"topic-bulk-actions"})},createNewTopicViaParams:function(e,o,t,i,n){this.openComposerWithTopicParams(this.controllerFor("discovery/topics"),e,o,t,i,n)},createNewMessageViaParams:function(e,o,t){this.openComposerWithMessageParams(e,o,t)}},activate:function(){this._super(),Em.run.next(function(){_.trigger("activate")})},handleShowLogin:function(){var e=this;if(this.siteSettings.enable_sso){var o=encodeURIComponent(window.location.pathname);window.location=Discourse.getURL("/session/sso?return_path="+o)}else this._autoLogin("login","login-modal",function(){return e.controllerFor("login").resetForm()})},handleShowCreateAccount:function(){if(this.siteSettings.enable_sso){var e=encodeURIComponent(window.location.pathname);window.location=Discourse.getURL("/session/sso?return_path="+e)}else this._autoLogin("createAccount","create-account")},_autoLogin:function(e,o,t){var i=w(this.siteSettings,this.container.lookup("capabilities:main"),this.site.isMobileDevice);this.siteSettings.enable_local_logins||1!==i.length?(g(e),this.controllerFor("modal").set("modalClass",o),t&&t()):this.controllerFor("login").send("externalLogin",i[0])}});RSVP.EventTarget.mixin(_),l.default=_});
//# sourceMappingURL=/assets/discourse/routes/application-657ceabbc39289d7c42186d850f41b1300204ff134183073db70eb40ce17a6ed.js.map